
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{results\_overview}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \hypertarget{overview-of-available-variables-and-analysis-results}{%
\section{Overview of available variables and analysis
results}\label{overview-of-available-variables-and-analysis-results}}

Data analysis is supposed to be done in script \texttt{EVAL\_SCRIPT.py}
which can be found in the parent directory. This script is supposed to
create output files and plots that may be used here to summarise the
results.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}1}]:} \PY{k+kn}{import} \PY{n+nn}{os}
        \PY{k+kn}{import} \PY{n+nn}{pyaerocom} \PY{k}{as} \PY{n+nn}{pya}
        \PY{n}{pya}\PY{o}{.}\PY{n}{change\PYZus{}verbosity}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{critical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        \PY{k+kn}{import} \PY{n+nn}{EVAL\PYZus{}POST} \PY{k}{as} \PY{n+nn}{helpers}
        
        \PY{n}{IMPORT\PYZus{}MODEL\PYZus{}DATA} \PY{o}{=} \PY{l+m+mi}{0}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
2018-08-21 14:05:13,682:INFO:
Reading aliases ini file: /home/jonasg/github/pyaerocom/pyaerocom/data/aliases.ini

    \end{Verbatim}

    Check for updates in file containing models.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}2}]:} \PY{n}{model\PYZus{}info\PYZus{}file} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/lustre/storeA/project/aerocom/aerocom\PYZhy{}users\PYZhy{}database/AEROCOM\PYZhy{}PHASE\PYZhy{}III/reference\PYZhy{}list}\PY{l+s+s1}{\PYZsq{}}
        
        \PY{k}{if} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{exists}\PY{p}{(}\PY{n}{model\PYZus{}info\PYZus{}file}\PY{p}{)}\PY{p}{:}
            \PY{k}{with} \PY{n+nb}{open}\PY{p}{(}\PY{n}{model\PYZus{}info\PYZus{}file}\PY{p}{)} \PY{k}{as} \PY{n}{f}\PY{p}{:}
                \PY{k}{for} \PY{n}{line} \PY{o+ow}{in} \PY{n}{f}\PY{p}{:}
                    \PY{k}{if} \PY{n}{line}\PY{o}{.}\PY{n}{strip}\PY{p}{(}\PY{p}{)}\PY{p}{:}
                        \PY{n+nb}{print}\PY{p}{(}\PY{n}{line}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
1 NorESM: AlfKirkevag MetNo

  CAM6-Oslo\_NF2kNucl\_7jun2018AK

attention

is on /lustre/storeA/project/aerocom/aerocom2/NorESM\_SVN\_TEST

2 OsloCTM3 : Gunnar Myhre - Marianne Lund CICERO

OsloCTM2\_INSITU  (includes extinction and absorption coefficients)

is probably outdated{\ldots}

3 TM5-AP3: Twan van Noye KNMI

TM5\_AP3-CTRL2016

and

TM5\_AP3-INSITU (daily files are missing, but Jan should produce them)


    \end{Verbatim}

    \hypertarget{define-models-obsnetworks-years-and-variables}{%
\subsubsection{Define models, obsnetworks, years, and
variables}\label{define-models-obsnetworks-years-and-variables}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}3}]:} \PY{n}{YEARS} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{2010}\PY{p}{,} \PY{l+m+mi}{2008}\PY{p}{,} \PY{l+m+mi}{9999}\PY{p}{]}
        
        \PY{c+c1}{\PYZsh{} List of models considered}
        \PY{n}{MODEL\PYZus{}LIST} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CAM6\PYZhy{}Oslo\PYZus{}NF2kNucl\PYZus{}7jun2018AK}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                      \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{OsloCTM2\PYZus{}INSITU}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                      \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{TM5\PYZus{}AP3\PYZhy{}CTRL2016}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                      \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{TM5\PYZus{}AP3\PYZhy{}INSITU}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        
        \PY{c+c1}{\PYZsh{} List of ungridded obsnetworks considered (so far)}
        \PY{n}{UNGRIDDED\PYZus{}OBS\PYZus{}NETWORKS} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{AeronetSunV2Lev2.daily}\PY{l+s+s1}{\PYZsq{}} \PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{od550aer}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                  \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{AeronetSunV3Lev2.daily}\PY{l+s+s1}{\PYZsq{}} \PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{od550aer}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                  \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{AeronetSDAV2Lev2.daily}\PY{l+s+s1}{\PYZsq{}} \PY{p}{:} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{od550lt1aer}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} 
                                                              \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{od550gt1aer}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                                  \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{AeronetSDAV3Lev2.daily}\PY{l+s+s1}{\PYZsq{}} \PY{p}{:} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{od550lt1aer}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} 
                                                              \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{od550gt1aer}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                                  \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{AeronetInvV2Lev2.daily}\PY{l+s+s1}{\PYZsq{}} \PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{abs550aer}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                  \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{AeronetInvV3Lev2.daily}\PY{l+s+s1}{\PYZsq{}} \PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{abs550aer}\PY{l+s+s1}{\PYZsq{}}
                                  \PY{p}{\PYZcb{}}
        
        \PY{c+c1}{\PYZsh{} Get unique variables}
        \PY{n}{VARS} \PY{o}{=} \PY{p}{[}\PY{p}{]}
        \PY{k}{for} \PY{n}{k}\PY{p}{,} \PY{n}{v} \PY{o+ow}{in} \PY{n}{UNGRIDDED\PYZus{}OBS\PYZus{}NETWORKS}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{:}
            \PY{k}{if} \PY{n+nb}{isinstance}\PY{p}{(}\PY{n}{v}\PY{p}{,} \PY{n+nb}{str}\PY{p}{)}\PY{p}{:}
                \PY{n}{VARS}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{v}\PY{p}{)}
            \PY{k}{else}\PY{p}{:}
                \PY{n}{VARS}\PY{o}{.}\PY{n}{extend}\PY{p}{(}\PY{n}{v}\PY{p}{)}
        \PY{n}{VARS} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{dict}\PY{o}{.}\PY{n}{fromkeys}\PY{p}{(}\PY{n}{VARS}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \hypertarget{import-model-results}{%
\subsubsection{Import model results}\label{import-model-results}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}4}]:} \PY{k}{if} \PY{n}{IMPORT\PYZus{}MODEL\PYZus{}DATA}\PY{p}{:}
            \PY{n}{read\PYZus{}models} \PY{o}{=} \PY{n}{pya}\PY{o}{.}\PY{n}{io}\PY{o}{.}\PY{n}{ReadGriddedMulti}\PY{p}{(}\PY{n}{MODEL\PYZus{}LIST}\PY{p}{)}
            \PY{n}{read\PYZus{}models}\PY{o}{.}\PY{n}{read\PYZus{}individual\PYZus{}years}\PY{p}{(}\PY{n}{VARS}\PY{p}{,} \PY{n}{YEARS}\PY{p}{)}
\end{Verbatim}


    Print overview of what is in the models

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}5}]:} \PY{k}{if} \PY{n}{IMPORT\PYZus{}MODEL\PYZus{}DATA}\PY{p}{:}
            \PY{n+nb}{print}\PY{p}{(}\PY{n}{read\PYZus{}models}\PY{p}{)}
\end{Verbatim}


    \hypertarget{results}{%
\subsection{Results}\label{results}}

This section contains results from the analysis that can be performed
using the script \texttt{EVAL\_SCRIPT.py}. The following lines read all
result CSV files that are stored in the result folder, imports them and
extracts \textbf{Bias (nmb), RMS and Pearson R coefficient)} as one
multiindex dataframe.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{n}{results} \PY{o}{=} \PY{n}{helpers}\PY{o}{.}\PY{n}{load\PYZus{}result\PYZus{}files}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}7}]:} \PY{n}{results} \PY{o}{=} \PY{n}{helpers}\PY{o}{.}\PY{n}{calc\PYZus{}stats}\PY{p}{(}\PY{n}{results}\PY{p}{)}
        \PY{n}{results}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}7}]:} \{'var\_name': 'od550aer',
         'ts\_type': 'monthly',
         'filter\_name': 'WORLD-noMOUNTAINS',
         'start': Timestamp('2008-01-16 00:00:00'),
         'stop': Timestamp('2008-12-15 00:00:00'),
         'data\_source\_idx': ['MODIS6.aqua', 'OsloCTM2\_INSITU'],
         'model\_id': 'OsloCTM2\_INSITU',
         'obs\_id': 'MODIS6.aqua',
         'year': 2008,
         'data':              ref      data
         0       0.016000  0.024142
         1       0.020000  0.024240
         2       0.037000  0.024667
         3       0.018000  0.029461
         4       0.072000  0.030581
         5       0.000000  0.031568
         6       0.000000  0.031568
         7       0.000000  0.030541
         8       0.027000  0.029256
         9       0.132000  0.029256
         10      0.013000  0.028451
         11      0.026000  0.028596
         12      0.000000  0.032312
         13      0.032000  0.032879
         14      0.001000  0.025887
         15      0.046000  0.026489
         16      0.059000  0.026489
         17      0.040000  0.024020
         18      0.290000  0.025100
         19      0.084000  0.018612
         20      0.038000  0.023656
         21      0.023800  0.023656
         22      0.031800  0.027166
         23      0.043400  0.028148
         24      0.038667  0.028148
         25      0.012000  0.030914
         26      0.014000  0.031003
         27      0.014000  0.031107
         28      0.033000  0.031669
         29      0.011000  0.031553
         {\ldots}          {\ldots}       {\ldots}
         541651  0.040964  0.021770
         541652  0.052200  0.021770
         541653  0.075375  0.021918
         541654  0.023000  0.022449
         541655  0.100783  0.022449
         541656  0.027727  0.022744
         541657  0.051542  0.023175
         541658  0.039000  0.022856
         541659  0.042077  0.022856
         541660  0.036231  0.022530
         541661  0.037500  0.022438
         541662  0.035200  0.022438
         541663  0.036963  0.022184
         541664  0.035120  0.022175
         541665  0.040962  0.022109
         541666  0.043833  0.021748
         541667  0.041680  0.021748
         541668  0.045259  0.021696
         541669  0.045074  0.021596
         541670  0.039208  0.021596
         541671  0.038783  0.021412
         541672  0.039708  0.021250
         541673  0.042545  0.021250
         541674  0.057458  0.021118
         541675  0.085857  0.021066
         541676  0.049864  0.021066
         541677  0.632000  0.018437
         541678  0.646000  0.018463
         541679  0.537000  0.018644
         541680  0.693000  0.021394
         
         [541681 rows x 2 columns],
         'refdata\_mean': 0.15749419437065323,
         'data\_mean': 0.05817277165592661,
         'rms': 0.1601706429510325,
         'nmb': -63.06354536534825,
         'mnmb': -83.20709184165173,
         'fge': 154.63651027892297,
         'R': 0.5440626135130181,
         'R\_spearman': 0.5574863218600248,
         'totnum': 541681,
         'success': 541681\}
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}8}]:} \PY{n}{table} \PY{o}{=} \PY{n}{helpers}\PY{o}{.}\PY{n}{to\PYZus{}multiindex\PYZus{}dataframe}\PY{p}{(}\PY{n}{results}\PY{p}{)}
        \PY{n}{table}\PY{o}{.}\PY{n}{sort\PYZus{}index}\PY{p}{(}\PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
        \PY{n}{table}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}8}]:}                                                                         Bias  \textbackslash{}
        Model            Year Freq    Variable    Obs                                  
        OsloCTM2\_INSITU  2008 monthly od550aer    AeronetSunV2Lev2.daily  -48.501611   
                                                  AeronetSunV3Lev2.daily  -56.196623   
                                                  MODIS6.aqua             -63.063545   
                                                  MODIS6.terra            -66.626111   
                              yearly  od550aer    MODIS6.aqua             -66.011154   
                                                  MODIS6.terra            -68.980735   
        TM5\_AP3-CTRL2016 2008 monthly abs550aer   AeronetInvV2Lev2.daily  -46.692645   
                                                  AeronetInvV3Lev2.daily  -36.976870   
                                      od550aer    AeronetSunV2Lev2.daily    0.914810   
                                                  AeronetSunV3Lev2.daily  -11.405708   
                                                  MODIS6.aqua             -19.689961   
                                                  MODIS6.terra            -27.477823   
                                      od550lt1aer AeronetSDAV2Lev2.daily -100.000000   
                                                  AeronetSDAV3Lev2.daily -100.000000   
                              yearly  od550aer    MODIS6.aqua             -26.311017   
                                                  MODIS6.terra            -32.787338   
                         2010 monthly abs550aer   AeronetInvV2Lev2.daily  -47.327784   
                                                  AeronetInvV3Lev2.daily  -37.627405   
                                      od550aer    AeronetSunV2Lev2.daily   -0.085802   
                                                  AeronetSunV3Lev2.daily   -8.427801   
                                                  MODIS6.aqua             -18.691015   
                                                  MODIS6.terra            -27.671878   
                                      od550lt1aer AeronetSDAV2Lev2.daily -100.000000   
                                                  AeronetSDAV3Lev2.daily -100.000000   
                              yearly  od550aer    MODIS6.aqua             -25.067594   
                                                  MODIS6.terra            -31.898424   
        TM5\_AP3-INSITU   2010 monthly abs550aer   AeronetInvV2Lev2.daily  -51.630777   
                                                  AeronetInvV3Lev2.daily  -42.872418   
                                      od550aer    AeronetSunV2Lev2.daily   -2.974804   
                                                  AeronetSunV3Lev2.daily  -11.279555   
                                                  MODIS6.aqua             -23.729018   
                                                  MODIS6.terra            -32.155734   
                                      od550lt1aer AeronetSDAV2Lev2.daily   10.296436   
                                                  AeronetSDAV3Lev2.daily    1.436546   
                              yearly  od550aer    MODIS6.aqua             -29.677098   
                                                  MODIS6.terra            -36.090511   
        
                                                                               RMS  \textbackslash{}
        Model            Year Freq    Variable    Obs                                
        OsloCTM2\_INSITU  2008 monthly od550aer    AeronetSunV2Lev2.daily  0.179537   
                                                  AeronetSunV3Lev2.daily  0.231221   
                                                  MODIS6.aqua             0.160171   
                                                  MODIS6.terra            0.173486   
                              yearly  od550aer    MODIS6.aqua             0.160594   
                                                  MODIS6.terra            0.161014   
        TM5\_AP3-CTRL2016 2008 monthly abs550aer   AeronetInvV2Lev2.daily  0.024975   
                                                  AeronetInvV3Lev2.daily  0.019355   
                                      od550aer    AeronetSunV2Lev2.daily  0.118533   
                                                  AeronetSunV3Lev2.daily  0.148455   
                                                  MODIS6.aqua             0.125377   
                                                  MODIS6.terra            0.131846   
                                      od550lt1aer AeronetSDAV2Lev2.daily  0.198325   
                                                  AeronetSDAV3Lev2.daily  0.241206   
                              yearly  od550aer    MODIS6.aqua             0.128101   
                                                  MODIS6.terra            0.120004   
                         2010 monthly abs550aer   AeronetInvV2Lev2.daily  0.027310   
                                                  AeronetInvV3Lev2.daily  0.021693   
                                      od550aer    AeronetSunV2Lev2.daily  0.121875   
                                                  AeronetSunV3Lev2.daily  0.185392   
                                                  MODIS6.aqua             0.124138   
                                                  MODIS6.terra            0.128279   
                                      od550lt1aer AeronetSDAV2Lev2.daily  0.192519   
                                                  AeronetSDAV3Lev2.daily  0.209227   
                              yearly  od550aer    MODIS6.aqua             0.120236   
                                                  MODIS6.terra            0.108985   
        TM5\_AP3-INSITU   2010 monthly abs550aer   AeronetInvV2Lev2.daily  0.029745   
                                                  AeronetInvV3Lev2.daily  0.024745   
                                      od550aer    AeronetSunV2Lev2.daily  0.128175   
                                                  AeronetSunV3Lev2.daily  0.190990   
                                                  MODIS6.aqua             0.125959   
                                                  MODIS6.terra            0.131302   
                                      od550lt1aer AeronetSDAV2Lev2.daily  0.093196   
                                                  AeronetSDAV3Lev2.daily  0.104295   
                              yearly  od550aer    MODIS6.aqua             0.121736   
                                                  MODIS6.terra            0.112043   
        
                                                                                 R  \textbackslash{}
        Model            Year Freq    Variable    Obs                                
        OsloCTM2\_INSITU  2008 monthly od550aer    AeronetSunV2Lev2.daily  0.639629   
                                                  AeronetSunV3Lev2.daily  0.590870   
                                                  MODIS6.aqua             0.544063   
                                                  MODIS6.terra            0.547657   
                              yearly  od550aer    MODIS6.aqua             0.454088   
                                                  MODIS6.terra            0.526248   
        TM5\_AP3-CTRL2016 2008 monthly abs550aer   AeronetInvV2Lev2.daily  0.576106   
                                                  AeronetInvV3Lev2.daily  0.633358   
                                      od550aer    AeronetSunV2Lev2.daily  0.805921   
                                                  AeronetSunV3Lev2.daily  0.787852   
                                                  MODIS6.aqua             0.605749   
                                                  MODIS6.terra            0.616421   
                                      od550lt1aer AeronetSDAV2Lev2.daily       NaN   
                                                  AeronetSDAV3Lev2.daily       NaN   
                              yearly  od550aer    MODIS6.aqua             0.497961   
                                                  MODIS6.terra            0.577687   
                         2010 monthly abs550aer   AeronetInvV2Lev2.daily  0.503721   
                                                  AeronetInvV3Lev2.daily  0.578789   
                                      od550aer    AeronetSunV2Lev2.daily  0.787676   
                                                  AeronetSunV3Lev2.daily  0.622730   
                                                  MODIS6.aqua             0.602976   
                                                  MODIS6.terra            0.624249   
                                      od550lt1aer AeronetSDAV2Lev2.daily       NaN   
                                                  AeronetSDAV3Lev2.daily       NaN   
                              yearly  od550aer    MODIS6.aqua             0.511972   
                                                  MODIS6.terra            0.614328   
        TM5\_AP3-INSITU   2010 monthly abs550aer   AeronetInvV2Lev2.daily  0.434678   
                                                  AeronetInvV3Lev2.daily  0.488387   
                                      od550aer    AeronetSunV2Lev2.daily  0.759281   
                                                  AeronetSunV3Lev2.daily  0.595196   
                                                  MODIS6.aqua             0.597824   
                                                  MODIS6.terra            0.619576   
                                      od550lt1aer AeronetSDAV2Lev2.daily  0.777637   
                                                  AeronetSDAV3Lev2.daily  0.768207   
                              yearly  od550aer    MODIS6.aqua             0.504913   
                                                  MODIS6.terra            0.607561   
        
                                                                                 FGE  
        Model            Year Freq    Variable    Obs                                 
        OsloCTM2\_INSITU  2008 monthly od550aer    AeronetSunV2Lev2.daily   74.531248  
                                                  AeronetSunV3Lev2.daily   79.735441  
                                                  MODIS6.aqua             154.636510  
                                                  MODIS6.terra            136.835215  
                              yearly  od550aer    MODIS6.aqua             132.706328  
                                                  MODIS6.terra            167.759778  
        TM5\_AP3-CTRL2016 2008 monthly abs550aer   AeronetInvV2Lev2.daily   70.695512  
                                                  AeronetInvV3Lev2.daily   61.631065  
                                      od550aer    AeronetSunV2Lev2.daily   30.055402  
                                                  AeronetSunV3Lev2.daily   32.356275  
                                                  MODIS6.aqua              63.272616  
                                                  MODIS6.terra             62.389958  
                                      od550lt1aer AeronetSDAV2Lev2.daily  200.000000  
                                                  AeronetSDAV3Lev2.daily  200.000000  
                              yearly  od550aer    MODIS6.aqua              43.367989  
                                                  MODIS6.terra             51.525671  
                         2010 monthly abs550aer   AeronetInvV2Lev2.daily   69.792652  
                                                  AeronetInvV3Lev2.daily   60.692149  
                                      od550aer    AeronetSunV2Lev2.daily   32.142630  
                                                  AeronetSunV3Lev2.daily   33.270703  
                                                  MODIS6.aqua              81.925838  
                                                  MODIS6.terra             56.885545  
                                      od550lt1aer AeronetSDAV2Lev2.daily  200.000000  
                                                  AeronetSDAV3Lev2.daily  200.000000  
                              yearly  od550aer    MODIS6.aqua              43.059851  
                                                  MODIS6.terra             50.670365  
        TM5\_AP3-INSITU   2010 monthly abs550aer   AeronetInvV2Lev2.daily   73.893456  
                                                  AeronetInvV3Lev2.daily   64.657799  
                                      od550aer    AeronetSunV2Lev2.daily   36.063356  
                                                  AeronetSunV3Lev2.daily   36.557452  
                                                  MODIS6.aqua             111.169446  
                                                  MODIS6.terra             74.038228  
                                      od550lt1aer AeronetSDAV2Lev2.daily   45.064873  
                                                  AeronetSDAV3Lev2.daily   43.122513  
                              yearly  od550aer    MODIS6.aqua              48.651364  
                                                  MODIS6.terra             55.676869  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}9}]:} \PY{n}{bias} \PY{o}{=} \PY{n}{table}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bias}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{unstack}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Model}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Freq}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
        \PY{k+kn}{from} \PY{n+nn}{IPython}\PY{n+nn}{.}\PY{n+nn}{display} \PY{k}{import} \PY{n}{display}\PY{p}{,} \PY{n}{Math}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}10}]:} \PY{n}{ax} \PY{o}{=} \PY{n}{pya}\PY{o}{.}\PY{n}{plot}\PY{o}{.}\PY{n}{heatmaps}\PY{o}{.}\PY{n}{df\PYZus{}to\PYZus{}heatmap}\PY{p}{(}\PY{n}{bias}\PY{p}{,} 
                                              \PY{n}{color\PYZus{}rowwise}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,}
                                              \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}
         \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Model Bias [}\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{]}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{display}\PY{p}{(}\PY{n}{Math}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{BIAS [}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{] = 100 }\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{cdot }\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{frac}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{sum\PYZus{}}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{i=1\PYZcb{}\PYZca{}}\PY{l+s+si}{\PYZob{}N\PYZcb{}}\PY{l+s+s1}{M\PYZus{}i\PYZhy{}O\PYZus{}i\PYZcb{}}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{sum\PYZus{}}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{i=1\PYZcb{}\PYZca{}}\PY{l+s+si}{\PYZob{}N\PYZcb{}}\PY{l+s+s1}{O\PYZus{}i\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n}{display}\PY{p}{(}\PY{n}{Math}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{N}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{,}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{hat}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{=\PYZcb{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{,Number}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{,of}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{,observations}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n}{display}\PY{p}{(}\PY{n}{Math}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{,}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{hat}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{=\PYZcb{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{,Model}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{,values}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n}{display}\PY{p}{(}\PY{n}{Math}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{O}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{,}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{hat}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{=\PYZcb{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{,Observation}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{,values}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    $$BIAS [\%] = 100 \cdot \frac{\sum_{i=1}^{N}M_i-O_i}{\sum_{i=1}^{N}O_i}$$

    
    $$N\,\hat{=}\,Number\,of\,observations$$

    
    $$M\,\hat{=}\,Model\,values$$

    
    $$O\,\hat{=}\,Observation\,values$$

    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_15_4.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}11}]:} \PY{n}{rms} \PY{o}{=} \PY{n}{table}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RMS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{unstack}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Model}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Freq}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{ax} \PY{o}{=} \PY{n}{pya}\PY{o}{.}\PY{n}{plot}\PY{o}{.}\PY{n}{heatmaps}\PY{o}{.}\PY{n}{df\PYZus{}to\PYZus{}heatmap}\PY{p}{(}\PY{n}{rms}\PY{p}{,} \PY{n}{color\PYZus{}rowwise}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,}
                                              \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}
         \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RMS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{display}\PY{p}{(}\PY{n}{Math}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RMS = }\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{sqrt}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{frac}\PY{l+s+si}{\PYZob{}1\PYZcb{}}\PY{l+s+si}{\PYZob{}N\PYZcb{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{,}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{sum\PYZus{}}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{i=1\PYZcb{}\PYZca{}}\PY{l+s+si}{\PYZob{}N\PYZcb{}}\PY{l+s+s1}{(M\PYZhy{}O)\PYZus{}i\PYZca{}2\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n}{display}\PY{p}{(}\PY{n}{Math}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{N}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{,}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{hat}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{=\PYZcb{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{,Number}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{,of}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{,observations}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n}{display}\PY{p}{(}\PY{n}{Math}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{,}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{hat}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{=\PYZcb{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{,Model}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{,values}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n}{display}\PY{p}{(}\PY{n}{Math}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{O}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{,}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{hat}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{=\PYZcb{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{,Observation}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{,values}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    $$RMS = \sqrt{\frac{1}{N}\,\sum_{i=1}^{N}(M-O)_i^2}$$

    
    $$N\,\hat{=}\,Number\,of\,observations$$

    
    $$M\,\hat{=}\,Model\,values$$

    
    $$O\,\hat{=}\,Observation\,values$$

    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_16_4.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}12}]:} \PY{n}{fge} \PY{o}{=} \PY{n}{table}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FGE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{unstack}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Model}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Freq}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         
         \PY{n}{ax} \PY{o}{=} \PY{n}{pya}\PY{o}{.}\PY{n}{plot}\PY{o}{.}\PY{n}{heatmaps}\PY{o}{.}\PY{n}{df\PYZus{}to\PYZus{}heatmap}\PY{p}{(}\PY{n}{fge}\PY{p}{,} \PY{n}{color\PYZus{}rowwise}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,}
                                              \PY{n}{center}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}
         \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Fractional gross error}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{display}\PY{p}{(}\PY{n}{Math}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FGE}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{,[}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{] = }\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{frac}\PY{l+s+si}{\PYZob{}2\PYZcb{}}\PY{l+s+si}{\PYZob{}N\PYZcb{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{sum\PYZus{}}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{i=1\PYZcb{}\PYZca{}}\PY{l+s+si}{\PYZob{}N\PYZcb{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{left|}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{frac}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{M\PYZus{}i\PYZhy{}O\PYZus{}i\PYZcb{}}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{M\PYZus{}i+O\PYZus{}i\PYZcb{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{right|}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n}{display}\PY{p}{(}\PY{n}{Math}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{N}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{,}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{hat}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{=\PYZcb{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{,Number}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{,of}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{,observations}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n}{display}\PY{p}{(}\PY{n}{Math}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{,}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{hat}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{=\PYZcb{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{,Model}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{,values}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n}{display}\PY{p}{(}\PY{n}{Math}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{O}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{,}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{hat}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{=\PYZcb{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{,Observation}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{,values}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    $$FGE\,[\%] = \frac{2}{N}\sum_{i=1}^{N}\left|\frac{M_i-O_i}{M_i+O_i}\right|$$

    
    $$N\,\hat{=}\,Number\,of\,observations$$

    
    $$M\,\hat{=}\,Model\,values$$

    
    $$O\,\hat{=}\,Observation\,values$$

    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_17_4.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}13}]:} \PY{n}{corr} \PY{o}{=} \PY{n}{table}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{R}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{unstack}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Model}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Freq}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         
         \PY{n}{ax} \PY{o}{=} \PY{n}{pya}\PY{o}{.}\PY{n}{plot}\PY{o}{.}\PY{n}{heatmaps}\PY{o}{.}\PY{n}{df\PYZus{}to\PYZus{}heatmap}\PY{p}{(}\PY{n}{corr}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RdGy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color\PYZus{}rowwise}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,}
                                              \PY{n}{center}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}
         \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Pearson correlation}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{display}\PY{p}{(}\PY{n}{Math}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{R = }\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{frac}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{sum\PYZus{}}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{i=1\PYZcb{}\PYZca{}}\PY{l+s+si}{\PYZob{}N\PYZcb{}}\PY{l+s+s1}{(M\PYZus{}i\PYZhy{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{bar}\PY{l+s+si}{\PYZob{}M\PYZcb{}}\PY{l+s+s1}{)(O\PYZus{}i\PYZhy{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{bar}\PY{l+s+si}{\PYZob{}O\PYZcb{}}\PY{l+s+s1}{)\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}
                                  \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{sqrt}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{sum\PYZus{}}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{i=1\PYZcb{}\PYZca{}}\PY{l+s+si}{\PYZob{}N\PYZcb{}}\PY{l+s+s1}{(M\PYZus{}i\PYZhy{}}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{bar}\PY{l+s+si}{\PYZob{}M\PYZcb{}}\PY{l+s+s1}{)\PYZca{}2\PYZcb{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{sqrt}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{sum\PYZus{}}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{i=1\PYZcb{}\PYZca{}}\PY{l+s+si}{\PYZob{}N\PYZcb{}}\PY{l+s+s1}{(O\PYZus{}i\PYZhy{}}\PY{l+s+se}{\PYZbs{}\PYZbs{}}\PY{l+s+s1}{bar}\PY{l+s+si}{\PYZob{}O\PYZcb{}}\PY{l+s+s1}{)\PYZca{}2\PYZcb{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n}{display}\PY{p}{(}\PY{n}{Math}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{N}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{,}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{hat}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{=\PYZcb{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{,Number}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{,of}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{,observations}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n}{display}\PY{p}{(}\PY{n}{Math}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{,}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{hat}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{=\PYZcb{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{,Model}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{,values}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n}{display}\PY{p}{(}\PY{n}{Math}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{O}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{,}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{hat}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{=\PYZcb{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{,Observation}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{,values}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    $$R = \frac{\sum_{i=1}^{N}(M_i-\bar{M})(O_i-\bar{O})}{\sqrt{\sum_{i=1}^{N}(M_i-\bar{M})^2}\sqrt{\sum_{i=1}^{N}(O_i-\bar{O})^2}}$$

    
    $$N\,\hat{=}\,Number\,of\,observations$$

    
    $$M\,\hat{=}\,Model\,values$$

    
    $$O\,\hat{=}\,Observation\,values$$

    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_18_4.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{retrieval-of-statistical-parameters-from-collocated-data-testing}{%
\subsection{Retrieval of statistical parameters from collocated data
(testing)}\label{retrieval-of-statistical-parameters-from-collocated-data-testing}}

Currently, the statistical parameters like RMS are computed from the
difference vector of the model values and the corresponding
observations. This method does not take into account situations where
the slope of the distribution in the scatter plot deviates from 1,
i.e.~where the performance of the model as a function of the retrieved
parameter is dependent on the magnitude of the parameter.

This section aims to illustrate this issue and suggests to use a linear
fit (in loglog space) to consider both slope and offset (bias) of the
model values relative to the observations.

\hypertarget{examples}{%
\subsubsection{2 examples}\label{examples}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}20}]:} \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
         \PY{k}{def} \PY{n+nf}{plot\PYZus{}scatter}\PY{p}{(}\PY{n}{res}\PY{p}{,} \PY{n}{ax}\PY{p}{)}\PY{p}{:}
             \PY{n}{data}\PY{o}{=}\PY{n}{res}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{data}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
             
         
             \PY{n}{x}\PY{p}{,}\PY{n}{y} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ref}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{data}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
             \PY{n}{ax}\PY{o}{.}\PY{n}{loglog}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ +b}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{data}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlim}\PY{p}{(}\PY{p}{[}\PY{o}{.}\PY{l+m+mi}{01}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{]}\PY{p}{)}
             \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylim}\PY{p}{(}\PY{p}{[}\PY{o}{.}\PY{l+m+mi}{01}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{]}\PY{p}{)}
             \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{[}\PY{o}{.}\PY{l+m+mi}{01}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{.}\PY{l+m+mi}{01}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{]}\PY{p}{)}
         
             \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{n}{res}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{obs\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{n}{res}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{model\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{ (}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{)}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{res}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{var\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{res}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
             \PY{n}{m}\PY{p}{,} \PY{n}{c}  \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{polyfit}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{n}{x}\PY{p}{)}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{n}{y}\PY{p}{)}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{xvals}\PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{o}{.}\PY{l+m+mi}{01}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{,} \PY{l+m+mi}{100}\PY{p}{)}
             \PY{n}{y\PYZus{}fit} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{n}{m}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{n}{xvals}\PY{p}{)} \PY{o}{+} \PY{n}{c}\PY{p}{)}
             \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{xvals}\PY{p}{,} \PY{n}{y\PYZus{}fit}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Fit}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{ax}\PY{o}{.}\PY{n}{text}\PY{p}{(}\PY{l+m+mf}{0.012}\PY{p}{,} \PY{l+m+mf}{2.2}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RMS: }\PY{l+s+si}{\PYZob{}:.2f\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{res}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rms}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{12}\PY{p}{)}
             \PY{n}{ax}\PY{o}{.}\PY{n}{text}\PY{p}{(}\PY{l+m+mf}{0.012}\PY{p}{,} \PY{l+m+mf}{1.6}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bias: }\PY{l+s+si}{\PYZob{}:.2f\PYZcb{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{res}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{nmb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{12}\PY{p}{)}
             \PY{n}{ax}\PY{o}{.}\PY{n}{text}\PY{p}{(}\PY{l+m+mf}{0.012}\PY{p}{,} \PY{l+m+mf}{1.1}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FGE: }\PY{l+s+si}{\PYZob{}:.2f\PYZcb{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{res}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fge}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{12}\PY{p}{)}
             
             \PY{n}{ax}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
             
             \PY{k}{return} \PY{n}{ax}
         
         \PY{n}{ex1} \PY{o}{=} \PY{n}{results}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}
         \PY{n}{ex2} \PY{o}{=} \PY{n}{results}\PY{p}{[}\PY{l+m+mi}{6}\PY{p}{]}
         \PY{n}{fig}\PY{p}{,} \PY{p}{(}\PY{n}{ax1}\PY{p}{,} \PY{n}{ax2}\PY{p}{)} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{16}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}
         \PY{n}{plot\PYZus{}scatter}\PY{p}{(}\PY{n}{ex1}\PY{p}{,} \PY{n}{ax1}\PY{p}{)}
         \PY{n}{plot\PYZus{}scatter}\PY{p}{(}\PY{n}{ex2}\PY{p}{,} \PY{n}{ax2}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}20}]:} <matplotlib.axes.\_subplots.AxesSubplot at 0x7fb6aa71b9e8>
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_20_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    Assuming that the observations are true, in the ideal case, the results
should scatter around the one-one line in the plot, but clearly, the
fitted result shows, that the distribution is slanted with respect to
the one-one line. \textbf{This is not represented in the statistical
parameters that are caclulated based on the difference signal}.

Let's look at the difference signal of both examples as a function of
the AOD:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}15}]:} \PY{c+c1}{\PYZsh{} cpmpute difference vectors for both example datasets}
         \PY{n}{diff1} \PY{o}{=} \PY{n}{ex1}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{data}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{data}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{ex1}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{data}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ref}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{diff2} \PY{o}{=} \PY{n}{ex2}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{data}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{data}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{ex2}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{data}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ref}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         
         \PY{c+c1}{\PYZsh{} plot differences against corresponding values (using obs values)}
         \PY{n}{fig}\PY{p}{,} \PY{p}{(}\PY{n}{ax1}\PY{p}{,} \PY{n}{ax2}\PY{p}{)} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{16}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{ax1}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{ex1}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{data}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ref}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{diff1}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ +b}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Difference (example 1)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{ax1}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{ (}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{, }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{)}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{ex1}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{model\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{ex1}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{var\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{ex1}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
         \PY{n}{ax1}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{od550aer (obs)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{ax1}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{od550aer (model \PYZhy{} obs)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{ax2}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{ex2}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{data}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ref}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{diff2}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ +b}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Difference (example 2)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{ax2}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{ (}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{, }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{)}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{ex2}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{model\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{ex2}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{var\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{ex2}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
         \PY{n}{ax2}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{od550aer (obs)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{ax2}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{od550aer (model \PYZhy{} obs)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}15}]:} Text(0,0.5,'od550aer (model - obs)')
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_22_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    From the difference signals it becomes even more obvious that the
\textbf{\emph{performance}} of the models (i.e.~their capability to
\emph{reproduce} the observations) is clearly dependent on the value of
the AOD. E.g. model \emph{OsloCTM2\_INSITU 2008} shows linearly
increasing deviations to the observations with increasing AOD. At low
AODs, however, it matches considerably well.

\textbf{This is useful information and currently not represented by the
statistical parameters that disregard the fact that the performance may
be dependent on the values of the variable itself}

    \hypertarget{experimental-area}{%
\section{Experimental area}\label{experimental-area}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}16}]:} \PY{n}{data} \PY{o}{=} \PY{n}{results}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{data}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         
         \PY{n}{fig}\PY{p}{,} \PY{p}{(}\PY{n}{ax1}\PY{p}{,} \PY{n}{ax2}\PY{p}{)} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{16}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{x}\PY{p}{,}\PY{n}{y} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{obs}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{model}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{ax1}\PY{o}{.}\PY{n}{loglog}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ +b}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{data}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{m}\PY{p}{,} \PY{n}{c}  \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{polyfit}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{n}{x}\PY{p}{)}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{n}{y}\PY{p}{)}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{xvals}\PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{o}{.}\PY{l+m+mi}{01}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{,} \PY{l+m+mi}{100}\PY{p}{)}
         \PY{n}{y\PYZus{}fit} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{n}{m}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{n}{xvals}\PY{p}{)} \PY{o}{+} \PY{n}{c}\PY{p}{)}
         \PY{n}{ax1}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{xvals}\PY{p}{,} \PY{n}{y\PYZus{}fit}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Fit: }\PY{l+s+si}{\PYZob{}:.2f\PYZcb{}}\PY{l+s+s1}{x + }\PY{l+s+si}{\PYZob{}:.2f\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{m}\PY{p}{,} \PY{n}{c}\PY{p}{)}\PY{p}{)}
         \PY{n}{ax1}\PY{o}{.}\PY{n}{set\PYZus{}xlim}\PY{p}{(}\PY{p}{[}\PY{o}{.}\PY{l+m+mi}{01}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{]}\PY{p}{)}
         \PY{n}{ax1}\PY{o}{.}\PY{n}{set\PYZus{}ylim}\PY{p}{(}\PY{p}{[}\PY{o}{.}\PY{l+m+mi}{01}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{]}\PY{p}{)}
         \PY{n}{ax1}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{[}\PY{o}{.}\PY{l+m+mi}{01}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{.}\PY{l+m+mi}{01}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{]}\PY{p}{)}
         \PY{n}{ax1}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
         \PY{n}{ax1}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Aeronet Sun V2 L2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{ax1}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{TM5\PYZus{}AP3\PYZus{}CTRL2016}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{ax1}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{od550aer (2010)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{difference} \PY{o}{=} \PY{n}{y}\PY{o}{\PYZhy{}}\PY{n}{x}
         \PY{n}{ax2}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{difference}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ +b}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Model \PYZhy{} Obs}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{ax2}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Aeronet Sun V2 L2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{ax2}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Difference (model \PYZhy{} obs)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         
         \PY{n}{diff\PYZus{}fit} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{polyfit}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{difference}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{ax2}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{xvals}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{poly1d}\PY{p}{(}\PY{n}{diff\PYZus{}fit}\PY{p}{)}\PY{p}{(}\PY{n}{xvals}\PY{p}{)}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Fit: }\PY{l+s+si}{\PYZob{}:.2f\PYZcb{}}\PY{l+s+s1}{x + }\PY{l+s+si}{\PYZob{}:.2f\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{diff\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{diff\PYZus{}fit}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{)}
         \PY{n}{ax2}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
         \PY{n}{ax2}\PY{o}{.}\PY{n}{set\PYZus{}xlim}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]

        ---------------------------------------------------------------------------

        KeyError                                  Traceback (most recent call last)

        \textasciitilde{}/anaconda3/lib/python3.6/site-packages/pandas/core/indexes/base.py in get\_loc(self, key, method, tolerance)
       3063             try:
    -> 3064                 return self.\_engine.get\_loc(key)
       3065             except KeyError:


        pandas/\_libs/index.pyx in pandas.\_libs.index.IndexEngine.get\_loc()


        pandas/\_libs/index.pyx in pandas.\_libs.index.IndexEngine.get\_loc()


        pandas/\_libs/hashtable\_class\_helper.pxi in pandas.\_libs.hashtable.PyObjectHashTable.get\_item()


        pandas/\_libs/hashtable\_class\_helper.pxi in pandas.\_libs.hashtable.PyObjectHashTable.get\_item()


        KeyError: 'obs'

        
    During handling of the above exception, another exception occurred:


        KeyError                                  Traceback (most recent call last)

        <ipython-input-16-cab5cb0c9e49> in <module>()
          3 fig, (ax1, ax2) = plt.subplots(1,2, figsize=(16, 6))
          4 
    ----> 5 x,y = data['obs'], data['model']
          6 ax1.loglog(x, y, ' +b', label='data')
          7 


        \textasciitilde{}/anaconda3/lib/python3.6/site-packages/pandas/core/frame.py in \_\_getitem\_\_(self, key)
       2686             return self.\_getitem\_multilevel(key)
       2687         else:
    -> 2688             return self.\_getitem\_column(key)
       2689 
       2690     def \_getitem\_column(self, key):


        \textasciitilde{}/anaconda3/lib/python3.6/site-packages/pandas/core/frame.py in \_getitem\_column(self, key)
       2693         \# get column
       2694         if self.columns.is\_unique:
    -> 2695             return self.\_get\_item\_cache(key)
       2696 
       2697         \# duplicate columns \& possible reduce dimensionality


        \textasciitilde{}/anaconda3/lib/python3.6/site-packages/pandas/core/generic.py in \_get\_item\_cache(self, item)
       2484         res = cache.get(item)
       2485         if res is None:
    -> 2486             values = self.\_data.get(item)
       2487             res = self.\_box\_item\_values(item, values)
       2488             cache[item] = res


        \textasciitilde{}/anaconda3/lib/python3.6/site-packages/pandas/core/internals.py in get(self, item, fastpath)
       4113 
       4114             if not isna(item):
    -> 4115                 loc = self.items.get\_loc(item)
       4116             else:
       4117                 indexer = np.arange(len(self.items))[isna(self.items)]


        \textasciitilde{}/anaconda3/lib/python3.6/site-packages/pandas/core/indexes/base.py in get\_loc(self, key, method, tolerance)
       3064                 return self.\_engine.get\_loc(key)
       3065             except KeyError:
    -> 3066                 return self.\_engine.get\_loc(self.\_maybe\_cast\_indexer(key))
       3067 
       3068         indexer = self.get\_indexer([key], method=method, tolerance=tolerance)


        pandas/\_libs/index.pyx in pandas.\_libs.index.IndexEngine.get\_loc()


        pandas/\_libs/index.pyx in pandas.\_libs.index.IndexEngine.get\_loc()


        pandas/\_libs/hashtable\_class\_helper.pxi in pandas.\_libs.hashtable.PyObjectHashTable.get\_item()


        pandas/\_libs/hashtable\_class\_helper.pxi in pandas.\_libs.hashtable.PyObjectHashTable.get\_item()


        KeyError: 'obs'

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_25_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{k+kn}{import} \PY{n+nn}{seaborn} \PY{k}{as} \PY{n+nn}{sns}
        \PY{c+c1}{\PYZsh{}mybins=np.logspace(0,np.log(10),100)}
        \PY{n}{g} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{JointGrid}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{obs}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{model}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{data}\PY{p}{,} \PY{n}{xlim}\PY{o}{=}\PY{p}{[}\PY{l+m+mf}{0.01}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{]}\PY{p}{,}\PY{n}{ylim}\PY{o}{=}\PY{p}{[}\PY{l+m+mf}{0.01}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{]}\PY{p}{)}
        \PY{n}{g} \PY{o}{=} \PY{n}{g}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{sns}\PY{o}{.}\PY{n}{regplot}\PY{p}{,} \PY{n}{sns}\PY{o}{.}\PY{n}{distplot}\PY{p}{)}
        \PY{n}{ax} \PY{o}{=} \PY{n}{g}\PY{o}{.}\PY{n}{ax\PYZus{}joint}
        \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xscale}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{log}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}yscale}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{log}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{g}\PY{o}{.}\PY{n}{ax\PYZus{}marg\PYZus{}x}\PY{o}{.}\PY{n}{set\PYZus{}xscale}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{log}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{g}\PY{o}{.}\PY{n}{ax\PYZus{}marg\PYZus{}y}\PY{o}{.}\PY{n}{set\PYZus{}yscale}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{log}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}



    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
